- htitle "#{@user.name} - 个人页"

- hbreadcrumb '首页', '/'
- hbreadcrumb @user.name, "/users/#{@user.id}"

/ = subtabs

.page-user-show
  :ruby
    assigned_stories = @user.assigned_stories
  .head
    .avatar= avatar @user, :medium
    .meta
      .name= @user.name

    - Story::STATUSES.each do |status|
      .status{:class => status.downcase}
        .name= status
        .desc= status_to_str(status)

  .stories
    - Product.all.each do |product|
      :ruby
        product_stories = assigned_stories.of_product(product)

      - if product_stories.count > 0
        .product
          .meta
            .name= product.name
          - Story::STATUSES.each do |status|
            .status
              - stories = product_stories.with_status(status)
              - if stories.count > 0
                - # y = 80 - 40 / x
                - # x = 1, y = 40
                - # x -> ∞, y = 80
                :ruby
                  # x = [stories.count, 101].min 
                  # w = 80 - 40 / stories.count
                  w = 50
                  style = "width:#{w}px;height:#{w}px;line-height:#{w}px;"
                  style += "margin:#{58 - w/2}px"

                .count{:class=>status.downcase, :style=>style}= stories.count

  
  - if !@user.member_info.github_homepage.blank?
    :ruby
      github_user = @user.github_user

    .github-user
      .avatar= link_to(image_tag(github_user.avatar_url), github_user.html_url, :target => "_blank")

      .login
        %span 登录
        %span=github_user.login

      .name
        %span 名称
        %span=github_user.name

      .company
        %span 公司
        %span=github_user.company


      .blog
        %span 博客
        %span=github_user.blog


      .location
        %span 位置
        %span=github_user.location


      .email
        %span Email
        %span=github_user.email


      .followers
        %span Followers
        %span=github_user.followers


      .following
        %span Following
        %span=github_user.following


      .bio
        %span Bio
        %span=github_user.bio



      .html-url
        %span Html Url
        %span=github_user.html_url


      .public-repos
        %span Public Repos
        %span=github_user.public_repos


      .public-gists
        %span Public Gists
        %span=github_user.public_gists


      .github-created-at
        %span Bio
        %span=github_user.github_created_at

